# Longhorn storage configuration values
# These values configure StorageClasses and snapshot policies for the homelab
#
# IMPORTANT: Never include 'fromBackup' in StorageClass parameters.
# Even an empty string triggers Longhorn v1.10.x webhook deadlock.

# StorageClass configurations
storageClasses:
  homelab:
    name: longhorn-homelab
    isDefault: true
    numberOfReplicas: 1  # Single-node homelab - no replication needed
    dataLocality: best-effort
    fsType: ext4
    reclaimPolicy: Retain
    allowVolumeExpansion: true
    staleReplicaTimeout: 30  # Minutes before marking replica stale
    nodeSelector: homelab     # Schedule on homelab node's /data/longhorn disk

  gpuLocal:
    name: longhorn-gpu-local
    isDefault: false
    numberOfReplicas: 1
    dataLocality: strict-local
    fsType: ext4
    reclaimPolicy: Retain
    allowVolumeExpansion: true
    staleReplicaTimeout: 30

# Recurring snapshot configuration
# NOTE: Only 'snapshot' tasks are configured. 'backup' tasks require a
# backup target URL (S3/NFS) which is not set up for this homelab.
# Do NOT create backup RecurringJobs without configuring a backup target first.
recurringJobs:
  dailySnapshot:
    name: daily-snapshot
    cron: "0 2 * * *"
    task: snapshot
    retain: 7
    concurrency: 2
    labels:
      backup-type: daily

# Default volume labels
defaultLabels:
  environment: homelab
  managed-by: argocd
