image:
  repository: bitnami/redis
  tag: "latest"
  pullPolicy: IfNotPresent

service:
  type: ClusterIP
  port: 6379

auth:
  enabled: true
  existingSecret: redis-secret
  passwordKey: redis-password

# Security context for rootless execution
securityContext:
  enabled: true
  runAsUser: 1001
  runAsGroup: 1001
  fsGroup: 1001
  runAsNonRoot: true
  fsGroupChangePolicy: "OnRootMismatch"

# Redis extra flags (memory management)
# allkeys-lru: Evict least recently used keys when maxmemory is reached
# Prevents OOM crashes and ensures Redis stays within memory limits
extraFlags: "--maxmemory 768mb --maxmemory-policy allkeys-lru --save 60 1000 --save 300 100"

persistence:
  enabled: true
  size: 8Gi
  storageClass: "longhorn"
  accessMode: ReadWriteOnce

resources:
  requests:
    cpu: 100m
    memory: 256Mi
  limits:
    cpu: 500m
    memory: 1Gi

nodeSelector:
  kubernetes.io/hostname: homelab
tolerations: []
affinity: {}
